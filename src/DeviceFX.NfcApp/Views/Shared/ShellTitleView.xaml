<?xml version="1.0" encoding="utf-8"?>

<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:ffimageloading="clr-namespace:FFImageLoading.Maui;assembly=FFImageLoading.Maui"
             x:Name="This"
             x:Class="DeviceFX.NfcApp.Views.Shared.ShellTitleView">
    <Grid VerticalOptions="Center" HeightRequest="44" ColumnDefinitions="44,*,44">
        <Grid.Margin>
            <OnPlatform x:TypeArguments="Thickness">
                <On Platform="Android" Value="16,0"/>
            </OnPlatform>
        </Grid.Margin>
        <Border
            StrokeThickness="0"
            StrokeShape="RoundRectangle 22,22,22,22"
            HorizontalOptions="Center"
            VerticalOptions="Center"
            WidthRequest="40"
            HeightRequest="40">
            <ffimageloading:CachedImage Source="{Binding Settings.ImageSource}"
                                        CacheType="All" 
                                        LoadingPlaceholder="grey_settings_gear.png"
                                        ErrorPlaceholder="grey_settings_gear.png"
                                        HorizontalOptions="Center" />
            <Border.GestureRecognizers>
                <TapGestureRecognizer Command="{Binding OpenSettingsCommand}"></TapGestureRecognizer>
            </Border.GestureRecognizers>
        </Border>
        <Label Grid.Column="1"
               TextColor="White"
               FontSize="Large"
               FontAttributes="Bold"
               HorizontalTextAlignment="Center"
               VerticalTextAlignment="Center"
               Text="{Binding Title}" />
        <ImageButton 
            Grid.Column="2"
            IsVisible="False"
            x:Name="OperationButton"
            Source="recycle_icon.png"
            Command="{Binding OperationCommand}"
            WidthRequest="32"
            HeightRequest="32"
            HorizontalOptions="Start">
            <Image.Behaviors>
                <toolkit:IconTintColorBehavior TintColor="{Binding Operation.TintColor}" />
            </Image.Behaviors>
        </ImageButton>
    </Grid>
</ContentView>